---

service:
  name: "example"
  echo_colors: true
  echo_level: debug


external:
  service_name: {}


brokers:
  default_broker:
    import_template: "example.brokers.kafka_broker:KafkaBroker"
    api_version: [ 0, 10 ]

  ender_broker:
    import_template: "example.brokers.uni_log_broker:LogBroker"

  mem_broker:
    import_template: "unipipeline.brokers.uni_memory_broker:UniMemoryBroker"

  rmq_broker:
    import_template: "example.brokers.rmq_broker:RmqBroker"

  kafka_broker:
    import_template: "example.brokers.kafka_broker:KafkaBroker"
    api_version: [ 0, 10 ]


messages:
  __default__:
    import_template: "example.messages.{{name}}:{{name|camel}}"

  input_message: {}

  inetermediate_message: {}

  ender_message: {}


cron:
  my_super_task:
    worker: my_super_cron_worker
    when: 0/1 * * * *

  my_mega_task:
    worker: my_super_cron_worker
    when: 0/2 * * * *

  my_puper_task:
    worker: my_super_cron_worker
    when: 0/3 * * * *


waitings:
  __default__:
    import_template: example.waitings.{{name}}_wating:{{name|camel}}Waiting

  common_db: {}


workers:
  __default__:
    broker: mem_broker
    import_template: "example.workers.{{name}}:{{name|camel}}"

  my_super_cron_worker:
    broker: mem_broker
    input_message: uni_cron_message
    output_workers:
      - ender_second_worker

  input_worker:
    broker: mem_broker
    input_message: input_message
    waiting_for:
      - common_db

  intermediate_first_worker:
    input_message: inetermediate_message
    output_workers:
      - ender_second_worker
    waiting_for:
      - common_db

  intermediate_second_worker:
    input_message: inetermediate_message
    external: service_name
    output_workers:
      - ender_frist_worker

  ender_frist_worker:
    input_message: ender_message

  ender_second_worker:
    input_message: ender_message
    output_message: ender_message
    broker: mem_broker
    waiting_for:
      - common_db
